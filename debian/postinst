#!/bin/sh -e
case "$1" in
	configure)
		# Create the osmocom group and user (if it doesn't exist yet)
		if ! getent group osmocom >/dev/null; then
			groupadd --system osmocom
		fi
		if ! getent passwd osmocom >/dev/null; then
			useradd \
				--system \
				--gid osmocom \
				--home-dir /var/lib/osmocom \
				--shell /sbin/nologin \
				--comment "Open Source Mobile Communications" \
				osmocom
		fi

		# Fix permissions of previous (root-owned) install (OS#4107)
		chown osmocom:osmocom /etc/osmocom/osmo-msc.cfg
		chmod 0660 /etc/osmocom/osmo-msc.cfg
		chown root:osmocom /etc/osmocom
		chmod 2775 /etc/osmocom
		mkdir -p /var/lib/osmocom
		chown -R osmocom:osmocom /var/lib/osmocom
		;;
esac

# dh_installdeb(1) will replace this with shell code automatically
# generated by other debhelper scripts.
#DEBHELPER#
